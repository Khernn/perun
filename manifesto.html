
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Perun Manifesto &#8212; Perun 0.12 documentation</title>
    <link rel="stylesheet" href="_static/perun.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.12',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="perun-manifesto">
<h1><a class="toc-backref" href="#id1">Perun Manifesto</a><a class="headerlink" href="#perun-manifesto" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#perun-manifesto" id="id1">Perun Manifesto</a><ul>
<li><a class="reference internal" href="#perun-design-choices" id="id2">Perun Design Choices</a><ul>
<li><a class="reference internal" href="#language-of-choice" id="id3">Language of Choice</a></li>
<li><a class="reference internal" href="#cli-framework-of-choice" id="id4">CLI Framework of Choice</a></li>
<li><a class="reference internal" href="#gui-framework-of-choice" id="id5">GUI Framework of Choice</a></li>
<li><a class="reference internal" href="#visualization-of-choice" id="id6">Visualization of Choice</a></li>
<li><a class="reference internal" href="#structure-of-perun" id="id7">Structure of Perun</a></li>
</ul>
</li>
<li><a class="reference internal" href="#perun-overview" id="id8">Perun Overview</a></li>
<li><a class="reference internal" href="#perun-command-line-interface" id="id9">Perun Command Line Interface</a><ul>
<li><a class="reference internal" href="#perun-least-publishable-unit" id="id10">Perun Least Publishable Unit</a></li>
</ul>
</li>
<li><a class="reference internal" href="#perun-core" id="id11">Perun Core</a><ul>
<li><a class="reference internal" href="#perun-config" id="id12">Perun Config</a></li>
<li><a class="reference internal" href="#perun-internals" id="id13">Perun Internals</a><ul>
<li><a class="reference internal" href="#command-case-study-init-new-perun-control-system" id="id14">Command Case Study: Init new perun control system</a></li>
<li><a class="reference internal" href="#command-case-study-add-profile" id="id15">Command Case Study: Add profile</a></li>
<li><a class="reference internal" href="#command-case-study-remove-profile" id="id16">Command Case Study: Remove profile</a></li>
<li><a class="reference internal" href="#command-case-study-show-profile" id="id17">Command Case Study: Show profile</a></li>
<li><a class="reference internal" href="#command-case-study-show-all-minor-versions-and-profiles" id="id18">Command Case Study: Show all minor versions and profiles</a></li>
</ul>
</li>
<li><a class="reference internal" href="#core-logic-package" id="id19"><code class="docutils literal"><span class="pre">core/logic</span></code> Package</a><ul>
<li><a class="reference internal" href="#job-matrix" id="id20">Job Matrix</a></li>
<li><a class="reference internal" href="#template-for-runners" id="id21">Template for Runners</a></li>
<li><a class="reference internal" href="#runner-scheduler" id="id22">Runner Scheduler</a></li>
</ul>
</li>
<li><a class="reference internal" href="#core-data-package" id="id23"><code class="docutils literal"><span class="pre">core/data</span></code> Package</a></li>
<li><a class="reference internal" href="#view-package" id="id24"><code class="docutils literal"><span class="pre">view</span></code> Package</a></li>
</ul>
</li>
<li><a class="reference internal" href="#profiles" id="id25">Profiles</a><ul>
<li><a class="reference internal" href="#profile-types" id="id26">Profile types</a><ul>
<li><a class="reference internal" href="#collective-profiles" id="id27">Collective Profiles</a></li>
<li><a class="reference internal" href="#differential-profiles" id="id28">Differential Profiles</a></li>
</ul>
</li>
<li><a class="reference internal" href="#profile-visualizations" id="id29">Profile visualizations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#perun-modes" id="id30">Perun Modes</a><ul>
<li><a class="reference internal" href="#offline-mode" id="id31">Offline Mode</a></li>
<li><a class="reference internal" href="#online-mode" id="id32">Online Mode</a></li>
<li><a class="reference internal" href="#mixed-mode" id="id33">Mixed Mode</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-features" id="id34">Other Features</a><ul>
<li><a class="reference internal" href="#notifications" id="id35">Notifications</a></li>
<li><a class="reference internal" href="#performance-statistics" id="id36">Performance Statistics</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="perun-design-choices">
<h2><a class="toc-backref" href="#id2">Perun Design Choices</a><a class="headerlink" href="#perun-design-choices" title="Permalink to this headline">¶</a></h2>
<p>This section explains some of the design choices, that were made.
Perun was made with the following goals in mind:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Platform independent—profiling and version controling can be
done both on Unix/Windows/MacOS systems.</li>
<li>Language independent—perun should be independent on the underlying
project language (this also complies with the Point 1.).</li>
<li>Lightweight—perun should not be robust, should be easy to install,
and easy and natural to use. Morever, one should be able to change the
innermost data as well.</li>
<li>Efficient—eficiency is one of the factors of perun—both in terms of
space and time consumption.</li>
<li>Fresh and modern—for authors, this serves as great experience for
exploring modern and fresh technologies and thus appropriate frameworks
are usually chosen.</li>
</ol>
</div></blockquote>
<p>This section only serves as self-assurance and possible explanation, why perun
is implemented as it is.</p>
<div class="section" id="language-of-choice">
<h3><a class="toc-backref" href="#id3">Language of Choice</a><a class="headerlink" href="#language-of-choice" title="Permalink to this headline">¶</a></h3>
<p><strong>Python</strong> was chosen as the implementation language, both for having large number
of frameworks and libraries and being platform independent. Moreover the implementation
in python is lightweight without need to solve memory allocation and other architecture
specific details.</p>
</div>
<div class="section" id="cli-framework-of-choice">
<h3><a class="toc-backref" href="#id4">CLI Framework of Choice</a><a class="headerlink" href="#cli-framework-of-choice" title="Permalink to this headline">¶</a></h3>
<p><strong>Click</strong> was chosen as the framework for command line interface. <code class="docutils literal"><span class="pre">Docopts</span></code> was ruled out
for being hard to use, through the docstrings. Click is built over the <code class="docutils literal"><span class="pre">getopts</span></code> and is
similar to the classical <code class="docutils literal"><span class="pre">argparse</span></code>, however, is much easier to use and also
enables nesting of the commands, that is necessary for the command line work with
repository-like structure.</p>
</div>
<div class="section" id="gui-framework-of-choice">
<h3><a class="toc-backref" href="#id5">GUI Framework of Choice</a><a class="headerlink" href="#gui-framework-of-choice" title="Permalink to this headline">¶</a></h3>
<p><strong>Kivy</strong> was chose as the framework for graphical user interface. While other frameworks
were considered as well (like <strong>PyQT</strong>), kivy seems natural for multi-platform applications
and provides nice look. Moreover, <code class="docutils literal"><span class="pre">Kivy</span></code> has clear separation between presentation and
logic.</p>
</div>
<div class="section" id="visualization-of-choice">
<h3><a class="toc-backref" href="#id6">Visualization of Choice</a><a class="headerlink" href="#visualization-of-choice" title="Permalink to this headline">¶</a></h3>
<p>Currently under consideration. Current candidates are: <strong>Bokeh</strong> and <strong>Mathplotlib</strong>.
<strong>Mathplotlib</strong> is easier to integrate in GUI application of <code class="docutils literal"><span class="pre">Kivy</span></code>, however, has
less options and is harder to use. <strong>Bokeh</strong>, on the other hand, is easy to use and
provides lots of customization.</p>
</div>
<div class="section" id="structure-of-perun">
<h3><a class="toc-backref" href="#id7">Structure of Perun</a><a class="headerlink" href="#structure-of-perun" title="Permalink to this headline">¶</a></h3>
<p>The implementation details of perun storage is inspired by <strong>GIT</strong> design.
While it was considered to use database (like <strong>MongoDB</strong>, that would solve
the efficient storage), we felt, that it would be too robust and will add a layer
of complexity. Instead with the low-level approach to storing the profiles and
other informations enables one to have full control over the Performance Control System
using both low-level and high-level commands. Moreover, the interlacing between VCS and PCS,
like e.g. for <strong>GIT</strong> is then natural and enables one some pretty neat tricks automatizations.</p>
</div>
</div>
<div class="section" id="perun-overview">
<h2><a class="toc-backref" href="#id8">Perun Overview</a><a class="headerlink" href="#perun-overview" title="Permalink to this headline">¶</a></h2>
<p>Perun logic is similar to the MVC (Model-View-Controler) architecture
and consists of three main parts:</p>
<blockquote>
<div><ol class="arabic simple">
<li><strong>Data</strong> (Model)—wraps VCS and its Major Version with parallel
PCS structure and conveys the mapping of profiles to minor version.
Data has no own logics, and only servers as midlayer between various
VCS, like. GIT, SVN, etc.</li>
<li><strong>Logic</strong> (Controller)—conveys the main logic of the PCS, updates
the data and issues viewing of the data either in GUI or CLI applications.
Controller consists of Preprocessors, that prepares the source files for
profiling, and Runners that provides profiles. Logic includes layers for
VCS hooks, external programs, etc.</li>
<li><strong>View</strong>—conveys the presentation of the data layer. This includes
Command Line Interface, that can either run as IDLE, or by using commands
in terminal; and moreover graphical interface implemented in Kivy framework.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="perun-command-line-interface">
<h2><a class="toc-backref" href="#id9">Perun Command Line Interface</a><a class="headerlink" href="#perun-command-line-interface" title="Permalink to this headline">¶</a></h2>
<p>The command line interface of Perun is realized using the <code class="docutils literal"><span class="pre">Click</span></code> python library,
that was chosen for its flexibility, easy usage and because it is under active development.
Moreover, it can handle nested commands required for repository-like behaviour.</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">config</span></code>—gets and sets the configuration for either global or local vcs</li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">help</span></code>—show help for the CLI and perun</li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">init</span></code>—inits the empty PCS within the directory as the directory <code class="docutils literal"><span class="pre">.perun</span></code>,
note that if there is existing <code class="docutils literal"><span class="pre">.perun</span></code> directory, the command fails with error<ul>
<li><code class="docutils literal"><span class="pre">--init-vcs=TYPE</span></code>—besides perun initialize the VCS repository of VCS type;
note that if there already exist vcs of <em>TYPE</em> <code class="docutils literal"><span class="pre">perun</span> <span class="pre">init</span></code> ends with error</li>
<li><code class="docutils literal"><span class="pre">--init-vcs-params=PARAMS</span></code>—supply additional parameters for <code class="docutils literal"><span class="pre">vcs</span> <span class="pre">init</span></code></li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">status</span></code>—shows some minor info, of what runners are currently pending, current
major and minor version<ul>
<li><code class="docutils literal"><span class="pre">--short</span></code>, <code class="docutils literal"><span class="pre">-s</span></code>—short status of the perun</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">diff</span> <span class="pre">PROFILE1</span> <span class="pre">PROFILE2</span></code>—shows diff between two chosen profiles,
represented by SHA-1 hashes<ul>
<li><code class="docutils literal"><span class="pre">-diff-algorithm=ALG</span></code>—use different diff strategy</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">add</span> <span class="pre">MINOR</span> <span class="pre">PROFILE</span></code>—manually adds profile to minor version<ul>
<li><code class="docutils literal"><span class="pre">--</span></code>—separate multiple files</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">rm</span></code>—remove either profile<ul>
<li><code class="docutils literal"><span class="pre">--</span></code>—separate multiple files</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">aggregate</span> <span class="pre">PROFILE1</span> <span class="pre">PROFILE2</span></code>—aggregates profile to one more generic one<ul>
<li><code class="docutils literal"><span class="pre">--strategy=STRATEGY</span></code>—will use different aggregation strategy</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">log</span> <span class="pre">MINOR</span></code>—shows current status, how many profiles are there asociated with each
minor versions, aggregated informations, statistics, etc.<ul>
<li><code class="docutils literal"><span class="pre">--count-only</span></code>—only shows number of profiles associated to minor versions</li>
<li><code class="docutils literal"><span class="pre">--show-aggregate</span></code>—shows aggregated profiles for each minor version</li>
<li><code class="docutils literal"><span class="pre">--last</span> <span class="pre">N</span></code>—print only last N minor versions</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">tag</span></code>—tags profiles with user given tags</li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">register</span></code>—register new runner for given workloads and major versions or
register new workload</li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">unregister</span></code>—unregister existing runners or workloads<ul>
<li><code class="docutils literal"><span class="pre">--</span></code>—separation of the list of register runners or workloads</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">show</span></code>—shows profile in CLI (note that this is textual representation mostly)<ul>
<li><code class="docutils literal"><span class="pre">--one-line</span></code>—displays the profile in one line</li>
<li><code class="docutils literal"><span class="pre">--coloured</span></code>—displays the profile with colours</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">bisect</span></code>—similar to git bisect to find quickly which minor version introduced
the peformance bug<ul>
<li><code class="docutils literal"><span class="pre">--auto</span></code>—try to infer the bad peformance commits automatically</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">query</span></code>—-query the profiles using the perun query language<ul>
<li><code class="docutils literal"><span class="pre">SELECT</span></code>—select profiles that satisfy the query</li>
<li><code class="docutils literal"><span class="pre">DROP</span></code>—remove profiles that satisfy the query</li>
<li><code class="docutils literal"><span class="pre">ADJUST</span></code>—adjust the values of profile according to the given transform function</li>
</ul>
</li>
</ul>
</div></blockquote>
<div class="section" id="perun-least-publishable-unit">
<h3><a class="toc-backref" href="#id10">Perun Least Publishable Unit</a><a class="headerlink" href="#perun-least-publishable-unit" title="Permalink to this headline">¶</a></h3>
<p>The least publishable unit (i.e. the minimalisitic prototype of the perun) contains the
following commands:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">help</span></code></li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">config</span></code></li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">init</span></code></li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">add</span></code></li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">rm</span></code></li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">log</span></code></li>
<li><code class="docutils literal"><span class="pre">perun</span> <span class="pre">show</span></code></li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="perun-core">
<h2><a class="toc-backref" href="#id11">Perun Core</a><a class="headerlink" href="#perun-core" title="Permalink to this headline">¶</a></h2>
<p>This section describes the internal structure of the Perun platform.</p>
<div class="section" id="perun-config">
<h3><a class="toc-backref" href="#id12">Perun Config</a><a class="headerlink" href="#perun-config" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">vcs</span></code>—information about underlying version control system</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="perun-internals">
<h3><a class="toc-backref" href="#id13">Perun Internals</a><a class="headerlink" href="#perun-internals" title="Permalink to this headline">¶</a></h3>
<p>The internal implementation of Perun is inspired by GIT Version Control System.
All of the internals corresponding to given Version Control System is stored
in the <code class="docutils literal"><span class="pre">.perun</span></code> directory. Removing this directory removes the tracking and
all of the profiles.</p>
<p>The <code class="docutils literal"><span class="pre">.perun</span></code> directory exploits the tree structure of changes in order to
achieve the incremental structure of the profiles.</p>
<p>The <code class="docutils literal"><span class="pre">.perun</span></code> directory contains the following files and special directories:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">HEAD</span></code>—currently “checked” out major version</li>
<li><code class="docutils literal"><span class="pre">objects\</span></code>—directory with objects (minor version indexes, profiles)</li>
<li><code class="docutils literal"><span class="pre">major-versions\</span></code>—directory with all major versions</li>
</ul>
</div></blockquote>
<p>Each major version corresponds to some minor version (that has some history
of previous minor versions), this way we get the history of our project in
order to execute diffs between minor versions. Minor versions points to indexes
that maps files and workloads to concrete profiles, which are packed using the
Zlib.</p>
<div class="section" id="command-case-study-init-new-perun-control-system">
<h4><a class="toc-backref" href="#id14">Command Case Study: Init new perun control system</a><a class="headerlink" href="#command-case-study-init-new-perun-control-system" title="Permalink to this headline">¶</a></h4>
<p>The user wants to initialize new perun pcs.</p>
<p>If the resulting pcs should be manual it is enough to run <code class="docutils literal"><span class="pre">perun</span> <span class="pre">init</span></code>.
The command will first check if there is not existing pcs and otherwise
creates a new <code class="docutils literal"><span class="pre">.perun</span></code> directory initialized with bare structure.</p>
<p>If the user wants to wrap the perun over existing vcs, the parameter <code class="docutils literal"><span class="pre">--type=VCS</span></code>
has to be given. The command first checks if there exists the vsc of
given type, then inits the perun the same way as bare init and
moreover install hooks for the given type of VCS.</p>
<p>Another alternation is to run the <code class="docutils literal"><span class="pre">init</span></code> with <code class="docutils literal"><span class="pre">--init-vcs</span></code> parameter
that along with perun creates a empty repository with given params.</p>
</div>
<div class="section" id="command-case-study-add-profile">
<h4><a class="toc-backref" href="#id15">Command Case Study: Add profile</a><a class="headerlink" href="#command-case-study-add-profile" title="Permalink to this headline">¶</a></h4>
<p>The user wants to manually add <code class="docutils literal"><span class="pre">PROFILE</span></code> corresponding to <code class="docutils literal"><span class="pre">MINOR</span></code> version.</p>
<p>Both <code class="docutils literal"><span class="pre">PROFILE</span></code> and <code class="docutils literal"><span class="pre">MINOR</span></code> is represented either using references (which
are further translated to SHA-1) or directly by SHA-1.</p>
<p>The input profile is taken and its SHA-1 is computed, which will be used for having unique
representation. The contents of the profile are packed using the Zlib library.</p>
<p>Then we lookup the <em>index</em> and <em>pack</em> for the given <code class="docutils literal"><span class="pre">MINOR</span></code> SHA-1. First two bytes
are taken that represents the directory, the rest of the 38 bytes are used to identify
corresponding minor version.</p>
<p>Inside the object, we update the fanout table at the start, for the given two bytes
of the <code class="docutils literal"><span class="pre">PROFILE</span></code> SHA-1. The appropriate entry is then added to the index file,
the offsets are updated according to the lenght of the added profile data.</p>
<p>The pack file is then extended by the contents of the given profile.</p>
</div>
<div class="section" id="command-case-study-remove-profile">
<h4><a class="toc-backref" href="#id16">Command Case Study: Remove profile</a><a class="headerlink" href="#command-case-study-remove-profile" title="Permalink to this headline">¶</a></h4>
<p>The user wants to manually remove <code class="docutils literal"><span class="pre">PROFILE</span></code> corresponding to <code class="docutils literal"><span class="pre">MINOR</span></code> version.</p>
<p>Both <code class="docutils literal"><span class="pre">PROFILE</span></code> and <code class="docutils literal"><span class="pre">MINOR</span></code> is represented the same as in the previous case study.</p>
<p>Similarly to previous study, the index file is looked up out of <code class="docutils literal"><span class="pre">MINOR</span></code> SHA-1 number.
Inside that we lookup the appropriate entry for the <code class="docutils literal"><span class="pre">PROFILE</span></code> SHA-1. The offset
is retrieved in order to locate the packed profile inside the pack.</p>
<p>Insides of the pack are removed, and the index is updated with new offsets.</p>
</div>
<div class="section" id="command-case-study-show-profile">
<h4><a class="toc-backref" href="#id17">Command Case Study: Show profile</a><a class="headerlink" href="#command-case-study-show-profile" title="Permalink to this headline">¶</a></h4>
<p>The user wants to show the <code class="docutils literal"><span class="pre">PROFILE</span></code> corresponding to <code class="docutils literal"><span class="pre">MINOR</span></code> version.</p>
<p>Both <code class="docutils literal"><span class="pre">PROFILE</span></code> and <code class="docutils literal"><span class="pre">MINOR</span></code> is represented the same as in the previous case study.</p>
<p>First we look into cache, which stores up to 10 (maybe more?) unpacked profiles for
fast access of the profiles, without the need of unpacking.</p>
<p>Similarly to previous study, the index file is looked up out of <code class="docutils literal"><span class="pre">MINOR</span></code> SHA-1 number.
Inside that we lookup the appropriate entry for the <code class="docutils literal"><span class="pre">PROFILE</span></code> SHA-1. The offset
is retrieved in order to locate the packed profile inside the pack.</p>
<p>The contents are retrieved from the pack, since we know the offset and the size of the
content from the index file. The given data are unpacked using Zlib and added to .cache
for quicker lookup.</p>
</div>
<div class="section" id="command-case-study-show-all-minor-versions-and-profiles">
<h4><a class="toc-backref" href="#id18">Command Case Study: Show all minor versions and profiles</a><a class="headerlink" href="#command-case-study-show-all-minor-versions-and-profiles" title="Permalink to this headline">¶</a></h4>
<p>The user wansts to get the list of all <code class="docutils literal"><span class="pre">MINOR</span></code> version corresponding to the
current <code class="docutils literal"><span class="pre">MAJOR</span></code> version (read from <code class="docutils literal"><span class="pre">HEAD</span></code> file).</p>
<p>First the HEAD reference is obtained, if no SHA-1 is supplied from command line.
which stores the SHA-1 of the most recent minor version. This serves as a starting point for the <code class="docutils literal"><span class="pre">perun</span> <span class="pre">log</span></code>.</p>
<p>Similarly to previous commands, the SHA-1 is used to locate the entry of the minor version.
Basic informations are printed out, and then the information about profiles. If the <code class="docutils literal"><span class="pre">--count-only</span></code>
is supplied, only fanout table is parsed and we return the number of profiles associated to the
minor version. Otherwise every profile in the index file is printed to the output.</p>
<p>After the minor version is parsed, we look at the parent of the minor version and
proceed same as for the previous commit. If we supplied the <code class="docutils literal"><span class="pre">--last=N</span></code> argument,
we print only <code class="docutils literal"><span class="pre">N</span></code> minor versions starting from the given SHA-1.</p>
</div>
</div>
<div class="section" id="core-logic-package">
<h3><a class="toc-backref" href="#id19"><code class="docutils literal"><span class="pre">core/logic</span></code> Package</a><a class="headerlink" href="#core-logic-package" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">core/logic</span></code> package consists of <strong>Runners</strong> and <strong>Preprocessors</strong>.</p>
<div class="section" id="job-matrix">
<h4><a class="toc-backref" href="#id20">Job Matrix</a><a class="headerlink" href="#job-matrix" title="Permalink to this headline">¶</a></h4>
<p>Perun builds on the ideas of travis, which uses the build matrix for continuous integration.
In the configuration file corresponding to the wrapped repository, there are specified collectors,
postprocess phases, and then the commands that will be run consisting of parameters, binaries
and workloads. Job matrix can e.g. look as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">collectors</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">time</span>
  <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">memory</span>
    <span class="n">sampling</span><span class="p">:</span> <span class="o">-</span><span class="n">s</span> <span class="mi">10</span>

<span class="n">postprocessors</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="nb">filter</span>
    <span class="n">params</span><span class="p">:</span> <span class="o">&lt;</span><span class="mi">20</span>
  <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">normalizer</span>

<span class="n">bins</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">gaston</span>
    <span class="n">params</span><span class="p">:</span>
      <span class="o">-</span><span class="n">p</span> <span class="o">-</span><span class="n">q</span> <span class="o">-</span><span class="n">g</span>
      <span class="o">-</span><span class="n">s</span> <span class="mi">10</span>
  <span class="o">-</span> <span class="n">mona</span>
    <span class="n">params</span><span class="p">:</span>
       <span class="o">-</span> <span class="n">q</span> <span class="o">-</span><span class="n">s</span>

<span class="n">workloads</span><span class="p">:</span>
   <span class="o">-</span> <span class="n">ex10</span><span class="o">.</span><span class="n">mona</span>
   <span class="o">-</span> <span class="n">ex14</span><span class="o">.</span><span class="n">mona</span>
</pre></div>
</div>
<p>The binaries are paired with their corresponding params and then the cartesian product is
constructed with workloads, this yield the following commands:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">gaston</span> <span class="pre">-p</span> <span class="pre">-q</span> <span class="pre">-g</span> <span class="pre">ex10.mona</span></code></li>
<li><code class="docutils literal"><span class="pre">gaston</span> <span class="pre">-s</span> <span class="pre">10</span> <span class="pre">ex10.mona</span></code></li>
<li><code class="docutils literal"><span class="pre">gaston</span> <span class="pre">-p</span> <span class="pre">-q</span> <span class="pre">-g</span> <span class="pre">ex14.mona</span></code></li>
<li><code class="docutils literal"><span class="pre">gaston</span> <span class="pre">-s</span> <span class="pre">10</span> <span class="pre">ex14.mona</span></code></li>
<li><code class="docutils literal"><span class="pre">mona</span> <span class="pre">-q</span> <span class="pre">-s</span> <span class="pre">ex10.mona</span></code></li>
<li><code class="docutils literal"><span class="pre">mona</span> <span class="pre">-q</span> <span class="pre">-s</span> <span class="pre">ex14.mona</span></code></li>
</ul>
</div></blockquote>
<p>Further the collectors are paired with the list or postprocesses yielding the following phases:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">time</span> <span class="pre">|</span> <span class="pre">filter</span> <span class="pre">&lt;20</span> <span class="pre">|</span> <span class="pre">normalizer</span></code></li>
<li><code class="docutils literal"><span class="pre">memory</span> <span class="pre">-s</span> <span class="pre">10</span> <span class="pre">|</span> <span class="pre">filter</span> <span class="pre">&lt;20</span> <span class="pre">|</span> <span class="pre">normalizer</span></code></li>
</ul>
</div></blockquote>
<p>Finally we do the cartesian product with the previous commands yield overall of 12 jobs.</p>
</div>
<div class="section" id="template-for-runners">
<h4><a class="toc-backref" href="#id21">Template for Runners</a><a class="headerlink" href="#template-for-runners" title="Permalink to this headline">¶</a></h4>
<p>Each runner <code class="docutils literal"><span class="pre">name</span></code> (e.g. postprocessor and collector) has to be defined in the package <code class="docutils literal"><span class="pre">name</span></code>
in the <code class="docutils literal"><span class="pre">name.py</span></code> module, in the corresponding <code class="docutils literal"><span class="pre">perun.{collect,postprocess}</span></code> package. So e.g.
the <code class="docutils literal"><span class="pre">time</span></code> collector will be defined inside the <code class="docutils literal"><span class="pre">perun.collect.time.time</span></code> module.</p>
<p>Inside the <code class="docutils literal"><span class="pre">name.py</span></code> are three functions with the following signatures:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">before(**kwargs)</span></code>—phase that is run before the <code class="docutils literal"><span class="pre">collect()</span></code> or <code class="docutils literal"><span class="pre">postprocess()</span></code> phases,
it is mainly for initialization of various data and/or to produce the runnable binary.</li>
<li><code class="docutils literal"><span class="pre">collect(**kwargs)</span></code>/<code class="docutils literal"><span class="pre">postprocess(**kwargs)</span></code>—the actual phase of the postprocessing or
collecting of the data. This phase should run the binary and collect either the whole profile
or at least the raw data. This phase is <strong>mandatory</strong>!</li>
<li><code class="docutils literal"><span class="pre">after(**kwargs)</span></code>—phase that is run after the main function. This serves as optional post
processing of the raw data or the computed profile.</li>
</ul>
</div></blockquote>
<p>Each of these functions should expect the data defined in the <code class="docutils literal"><span class="pre">header</span></code> part of the profile,
i.e. the command (<code class="docutils literal"><span class="pre">cmd</span></code>), arguments (<code class="docutils literal"><span class="pre">params</span></code>), workload (<code class="docutils literal"><span class="pre">workload</span></code>) and additional params
from the job matrix.</p>
<p>Each of these function should return the triple of <code class="docutils literal"><span class="pre">(status</span> <span class="pre">code,</span> <span class="pre">status</span> <span class="pre">msg,</span> <span class="pre">updated</span> <span class="pre">kwargs)</span></code>,
where:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">status</span> <span class="pre">code</span></code>—integer representing the status of the phase (0 for OK, nonzero for error),</li>
<li><code class="docutils literal"><span class="pre">status</span> <span class="pre">msg</span></code>—additional message of the status (mainly for error),</li>
<li><code class="docutils literal"><span class="pre">updated</span> <span class="pre">kwargs</span></code>—additional params that should be passed to the next phase</li>
</ul>
</div></blockquote>
<p>Either <code class="docutils literal"><span class="pre">after</span></code> or <code class="docutils literal"><span class="pre">collect</span></code>/<code class="docutils literal"><span class="pre">postprocess</span></code> function should return the profile in the updated
kwargs associated to the key <code class="docutils literal"><span class="pre">profile</span></code>.</p>
</div>
<div class="section" id="runner-scheduler">
<h4><a class="toc-backref" href="#id22">Runner Scheduler</a><a class="headerlink" href="#runner-scheduler" title="Permalink to this headline">¶</a></h4>
<p>Runner scheduler is the event driven manager, that manages the runs of asociated runners.
Each time we want to computed the profile, runner along with workload and type of run
is added to scheduler. The scheduled runs are then either run in parallel or sequentially
and generates profiles.</p>
<p>Runners have following modes:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">on_commit</span></code> (<code class="docutils literal"><span class="pre">on_new_version</span></code>)—asociated runners are run everytime
new Minor Version is commited to VCS (commit in GIT),</li>
<li><code class="docutils literal"><span class="pre">on_push</span></code> (<code class="docutils literal"><span class="pre">on_remote_upload</span></code>)—asociated runners are run everytime
local version control is pushed to remote control system,</li>
<li><code class="docutils literal"><span class="pre">on_checkout</span></code> (<code class="docutils literal"><span class="pre">on_backtrack_version</span></code>)—asociated runners are run everytime
older minor or major version is checked out,</li>
<li><code class="docutils literal"><span class="pre">on_demand</span></code>—asociated runners are manually run,</li>
<li><code class="docutils literal"><span class="pre">on_scheduled_time</span></code>—asociated runners are run at scheduled time and date</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="core-data-package">
<h3><a class="toc-backref" href="#id23"><code class="docutils literal"><span class="pre">core/data</span></code> Package</a><a class="headerlink" href="#core-data-package" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">core/data</span></code> package consists of <strong>Profiles</strong> and wrappers over <strong>Version Control Systems</strong>.</p>
</div>
<div class="section" id="view-package">
<h3><a class="toc-backref" href="#id24"><code class="docutils literal"><span class="pre">view</span></code> Package</a><a class="headerlink" href="#view-package" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">view</span></code> Package contains the <strong>GUI</strong> and <strong>Visualizers</strong> for the profiles.</p>
</div>
</div>
<div class="section" id="profiles">
<h2><a class="toc-backref" href="#id25">Profiles</a><a class="headerlink" href="#profiles" title="Permalink to this headline">¶</a></h2>
<p>Perun currently supports only three types of profiles (time, space, complexity).
These can be visualized with several strategies.</p>
<p>!Note that if the checked out Major Version has some uncommited changes, then the
computed profiles cannot be assigned to current minor version!</p>
<p>The main profile of Perun is based on JSON, which is suitable both for presentation
and manipulation within Python and Javascript, and moreover is human readable.</p>
<p>Aside from this format, various Adapters can be constructed to support more formats,
like e.g. Massif format,  callgrind, etc.</p>
<div class="section" id="profile-types">
<h3><a class="toc-backref" href="#id26">Profile types</a><a class="headerlink" href="#profile-types" title="Permalink to this headline">¶</a></h3>
<p>Our current focus is on the following types of profiles:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Time—amount of time the program spends on given workload</li>
<li>Space—amount of resources the program spends on given workload,
moreover, the mapping of objects to addresses.</li>
<li>Complexity—the complexity of the program or given/chosen functions</li>
</ol>
</div></blockquote>
<p>Perun profile format is currently under development, the current version is
described in the following snipped, where the # parts are used as comments for
the parts of the profile</p>
<p>Note that the minor_version is removed, as the profile can possibly correspond to more minor
versions, e.g. when nothing was changed with the commit:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Profile</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="c1"># General information about profile: its type</span>
    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;memory&#39;</span><span class="p">,</span>
    <span class="c1"># Command that was run and for which the data was collected</span>
    <span class="s1">&#39;cmd&#39;</span><span class="p">:</span> <span class="s1">&#39;/dir/subdir/bin&#39;</span><span class="p">,</span>
    <span class="c1"># Params used to run the command</span>
    <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="s1">&#39;-g -w -c&#39;</span><span class="p">,</span>
    <span class="c1"># Workload, i.e. some file/input/output supplied</span>
    <span class="s1">&#39;workload&#39;</span><span class="p">:</span> <span class="s1">&#39;load.in&#39;</span><span class="p">,</span>
    <span class="c1"># Units for the given types</span>
    <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s1">&#39;memory&#39;</span><span class="p">:</span> <span class="s1">&#39;MB&#39;</span><span class="p">,</span>
      <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;ns&#39;</span>
    <span class="p">]</span>
  <span class="p">}</span>

  <span class="c1"># Collector informations</span>
  <span class="s1">&#39;collector&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="c1"># The name of the run collector</span>
    <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;collector_name&#39;</span><span class="p">,</span>
    <span class="c1"># Parameters used during running of the collector</span>
    <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="s1">&#39;-sample 20 --no-recurse&#39;</span><span class="p">,</span>
  <span class="p">},</span>

  <span class="c1"># Information about all of the postprocessor phases</span>
  <span class="s1">&#39;postprocessors&#39;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;filter&#39;</span><span class="p">,</span> <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;30&#39;</span><span class="p">}</span>
  <span class="p">],</span>

  <span class="c1"># Information about result of the computation</span>
  <span class="s1">&#39;result&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="mi">0</span>
    <span class="s1">&#39;status-msg&#39;</span><span class="p">:</span> <span class="s1">&#39;everything was expensive&#39;</span>
  <span class="p">}</span>

  <span class="c1"># Global snapshot</span>
  <span class="s1">&#39;global&#39;</span><span class="p">:</span> <span class="p">{</span>
      <span class="c1"># Timestamp of the snapshot (when it ended)</span>
      <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="mf">12.32</span><span class="n">s</span><span class="p">,</span>
      <span class="c1"># List of resources corresponding to the snapshot with additional info</span>
      <span class="s1">&#39;resources&#39;</span><span class="p">:</span> <span class="p">[</span>
         <span class="c1"># Amount: how many of the resource it was consumed</span>
         <span class="c1"># Uid: unique identifier of the location or the resource</span>
         <span class="c1"># Type: type of the quantified resource</span>
         <span class="c1"># Trace: trace of the resource (callstacks, previous calls, whatever)</span>
         <span class="p">{</span>
           <span class="c1"># Amount of the consumed resources</span>
           <span class="s1">&#39;amount&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
           <span class="c1"># Unique identification of the resource: name of the function, etc.</span>
           <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="s1">&#39;/dir/subdir/loc&#39;</span><span class="p">,</span>
           <span class="c1"># Type of the consumed resources</span>
           <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;memory&#39;</span><span class="p">,</span>
           <span class="c1"># Subtype of the resource (e.g. time delta, malloc, calloc allocations, etc.)</span>
           <span class="s1">&#39;subtype&#39;</span><span class="p">:</span> <span class="s1">&#39;malloc&#39;</span><span class="p">,</span>
           <span class="c1"># Trace leading to the UID</span>
           <span class="s1">&#39;trace&#39;</span><span class="p">:</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
           <span class="c1"># Address where the resource was consumed (mainly for memory)</span>
           <span class="s1">&#39;address&#39;</span><span class="p">:</span> <span class="s1">&#39;242341243&#39;</span><span class="p">,</span>
           <span class="c1"># Number of units in the structure (for Jirka&#39;s BP)</span>
           <span class="s1">&#39;structure-unit-size&#39;</span><span class="p">:</span> <span class="mi">132</span><span class="p">,</span>
         <span class="p">},</span>
      <span class="p">]</span>
   <span class="p">},</span>

   <span class="c1"># List of snapshots containing objects similar to global one</span>
   <span class="s1">&#39;snapshots&#39;</span><span class="p">:</span> <span class="p">[</span>
     <span class="p">{</span>
       <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0s&#39;</span><span class="p">,</span>
       <span class="s1">&#39;resources&#39;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span><span class="s1">&#39;amount&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="n">MB</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="s1">&#39;/dir/subdir/loc#13&#39;</span> <span class="p">},</span>
          <span class="p">{</span><span class="s1">&#39;amount&#39;</span><span class="p">:</span>  <span class="mi">1</span><span class="n">MB</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="s1">&#39;/dir/subdir/loc#47&#39;</span> <span class="p">}</span>
       <span class="p">]</span>
     <span class="p">},</span>
     <span class="p">{</span>
       <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;2.0s&#39;</span><span class="p">,</span>
       <span class="s1">&#39;resources&#39;</span><span class="p">:</span> <span class="p">[</span>
          <span class="p">{</span><span class="s1">&#39;amount&#39;</span><span class="p">:</span> <span class="mi">37</span><span class="n">MB</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="s1">&#39;/dir/subdir/loc#13&#39;</span> <span class="p">},</span>
          <span class="p">{</span><span class="s1">&#39;amount&#39;</span><span class="p">:</span>  <span class="mi">3</span><span class="n">MB</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="s1">&#39;/dir/subdir/loc#47&#39;</span> <span class="p">}</span>
       <span class="p">]</span>
     <span class="p">}</span>
   <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Example of time profile, with data collected by <code class="docutils literal"><span class="pre">time</span></code> utility:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span>
  <span class="s1">&#39;minor_version&#39;</span><span class="p">:</span> <span class="n">a5cf40ebf33610c97083b209fc12a36adc3a99ff</span><span class="p">,</span>
  <span class="s1">&#39;cmd&#39;</span><span class="p">:</span> <span class="s1">&#39;/dir/subdir/bin&#39;</span><span class="p">,</span>
  <span class="s1">&#39;param&#39;</span><span class="p">:</span> <span class="s1">&#39;-g -w -v&#39;</span><span class="p">,</span>
  <span class="s1">&#39;workload&#39;</span><span class="p">:</span> <span class="s1">&#39;load.in&#39;</span><span class="p">,</span>

  <span class="s1">&#39;collector&#39;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span>
     <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span>
  <span class="p">},</span>

  <span class="s1">&#39;global&#39;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="mf">12.32</span><span class="n">s</span><span class="p">,</span>
      <span class="s1">&#39;resources&#39;</span><span class="p">:</span> <span class="p">[</span>
         <span class="p">{</span><span class="s1">&#39;amount&#39;</span><span class="p">:</span> <span class="mf">0.616</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="s1">&#39;real&#39;</span><span class="p">}</span>
         <span class="p">{</span><span class="s1">&#39;amount&#39;</span><span class="p">:</span> <span class="mf">0.500</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="s1">&#39;user&#39;</span><span class="p">}</span>
         <span class="p">{</span><span class="s1">&#39;amount&#39;</span><span class="p">:</span> <span class="mf">0.125</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="s1">&#39;sys&#39;</span><span class="p">}</span>
      <span class="p">]</span>
  <span class="p">},</span>

<span class="s1">&#39;snapshots&#39;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Example of mixed profile, with data collected by custom collector:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;mixed&#39;</span><span class="p">,</span>
  <span class="s1">&#39;minor_version&#39;</span><span class="p">:</span> <span class="n">a5cf40ebf33610c97083b209fc12a36adc3a99ff</span><span class="p">,</span>
  <span class="s1">&#39;cmd&#39;</span><span class="p">:</span> <span class="s1">&#39;./gaston&#39;</span><span class="p">,</span>
  <span class="s1">&#39;param&#39;</span><span class="p">:</span> <span class="s1">&#39;--serialize&#39;</span><span class="p">,</span>
  <span class="s1">&#39;workload&#39;</span><span class="p">:</span> <span class="s1">&#39;ex4.mona&#39;</span><span class="p">,</span>

  <span class="s1">&#39;collector&#39;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;gaston-collect&#39;</span><span class="p">,</span>
     <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span>
  <span class="p">},</span>

  <span class="s1">&#39;global&#39;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="mf">0.59</span><span class="n">s</span><span class="p">,</span>
     <span class="s1">&#39;resources&#39;</span><span class="p">:[</span>
        <span class="p">{</span><span class="s1">&#39;amount&#39;</span><span class="p">:</span> <span class="mf">0.10</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="s1">&#39;sa-creation&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;amount&#39;</span><span class="p">:</span> <span class="mf">0.45</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="s1">&#39;dec-proc&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;amount&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="s1">&#39;cleaning&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;amount&#39;</span><span class="p">:</span> <span class="mi">4817</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="s1">&#39;mona-space&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;term&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;amount&#39;</span><span class="p">:</span> <span class="mi">31712</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="s1">&#39;overall-space&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;term&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;amount&#39;</span><span class="p">:</span> <span class="mi">977296</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="s1">&#39;fixpoint-space&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;term&#39;</span><span class="p">}</span>
     <span class="p">]</span>
 <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Example of memory collected data:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;memory&#39;</span><span class="p">,</span>
  <span class="s1">&#39;minor_version&#39;</span><span class="p">:</span> <span class="n">a5cf40ebf33610c97083b209fc12a36adc3a99ff</span><span class="p">,</span>
  <span class="s1">&#39;cmd&#39;</span><span class="p">:</span> <span class="s1">&#39;./gaston&#39;</span><span class="p">,</span>
  <span class="s1">&#39;param&#39;</span><span class="p">:</span> <span class="s1">&#39;--serialize&#39;</span><span class="p">,</span>
  <span class="s1">&#39;workload&#39;</span><span class="p">:</span> <span class="s1">&#39;ex4.mona&#39;</span><span class="p">,</span>

  <span class="s1">&#39;collector&#39;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;massif&#39;</span><span class="p">,</span>
     <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span>
  <span class="p">},</span>

  <span class="s1">&#39;snapshots&#39;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="mi">123393017</span><span class="p">,</span>
      <span class="s1">&#39;resources&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;amount&#39;</span><span class="p">:</span> <span class="mi">4134891</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="s1">&#39;mem_heap_B&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;memory&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;amount&#39;</span><span class="p">:</span> <span class="mi">564725</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="s1">&#39;mem_heap_extra_B&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;memory&#39;</span><span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="mi">16162105</span><span class="p">,</span>
      <span class="s1">&#39;resources&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;amount&#39;</span><span class="p">:</span> <span class="mi">4134891</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="s1">&#39;mem_heap_B&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;memory&#39;</span><span class="p">},</span>
        <span class="p">{</span><span class="s1">&#39;amount&#39;</span><span class="p">:</span> <span class="mi">564725</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">:</span> <span class="s1">&#39;mem_heap_extra_B&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;memory&#39;</span><span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="collective-profiles">
<h4><a class="toc-backref" href="#id27">Collective Profiles</a><a class="headerlink" href="#collective-profiles" title="Permalink to this headline">¶</a></h4>
<p><em>Aggregated Profile</em> is computed by performing the aggreagion on two profiles, i.e.
creating the most general profile subsuming both of these profile.
Aggregated profiles are not supported for some types of profiles.</p>
<p>Profiles can be aggregated within the same Minor Version, either for the same workload
or for different workloads.
This yields so called <strong>Collective Profile</strong>.</p>
<p>Collective Profiles are computed either by relative info, and/or by assigning weight
to concrete profiles. Collective profiles serves as general information about the
current state of the performance for the given Minor Version.</p>
</div>
<div class="section" id="differential-profiles">
<h4><a class="toc-backref" href="#id28">Differential Profiles</a><a class="headerlink" href="#differential-profiles" title="Permalink to this headline">¶</a></h4>
<p><em>Differential Profile</em> (or Profile Diffs) are computed by performing diff between
two profiles of same type. In some cases the diff can fail and thus each diff has
to be run with given diff strategy, in order to infer missing or conflicting differences.</p>
</div>
</div>
<div class="section" id="profile-visualizations">
<h3><a class="toc-backref" href="#id29">Profile visualizations</a><a class="headerlink" href="#profile-visualizations" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li>Table</li>
<li>Graph</li>
<li>Flame Graph</li>
<li>Heat Map</li>
<li>Object Map</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="perun-modes">
<h2><a class="toc-backref" href="#id30">Perun Modes</a><a class="headerlink" href="#perun-modes" title="Permalink to this headline">¶</a></h2>
<p>Perun will be able to run in three modes:</p>
<blockquote>
<div><ol class="arabic simple">
<li><strong>Offline Mode</strong>—the default mode, where everything is run on the host system</li>
<li><strong>Online Mode</strong>—optional mode, where everything is run on remote system
(supported systems are (i) Travis and possibly (ii) Jenkins)</li>
<li><strong>Mixed Mode</strong>—mode, where some of the runners will run on host system,
and rest will run on remote system</li>
</ol>
</div></blockquote>
<p>Modes are set for each <em>Major Version</em> exclusively,
as we may need different performance testing for different Major Versions
(note that Major Versions corresponds to Branches in GIT VCS, where this makes sense).
By default, in every tracked <em>Version Control System</em> runs in <strong>Offline</strong>.</p>
<div class="section" id="offline-mode">
<h3><a class="toc-backref" href="#id31">Offline Mode</a><a class="headerlink" href="#offline-mode" title="Permalink to this headline">¶</a></h3>
<p>The default mode of the Perun. This can be further differentiated to following two strategies:</p>
<blockquote>
<div><ol class="arabic simple">
<li><strong>Eager Offline Mode</strong>—as soon as you commit, the runners are dispatched and
profiles are computed.</li>
<li><strong>Postponed Offline Mode</strong>—the runner jobs are batched in Scheduler to run
at specific or postponed times.</li>
</ol>
</div></blockquote>
<p>On client side this is achieved automatically by exploiting the hooks of the
version controls (for GIT this is achievable) or either by manual run.
For GIT, Perun supports the following hooks:</p>
<blockquote>
<div><ul class="simple">
<li><strong>git commit</strong>—run registered profiles, and optionally merges profiles to aggregated profile,</li>
<li><strong>git checkout</strong>—constructs actual profiles</li>
<li><strong>git branch</strong>—if constructing the new branch, the Perun will ask if
we want to copy the Perun specification file <code class="docutils literal"><span class="pre">.perun.yml</span></code> for the new branch</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="online-mode">
<h3><a class="toc-backref" href="#id32">Online Mode</a><a class="headerlink" href="#online-mode" title="Permalink to this headline">¶</a></h3>
<p>Online mode requires that the tracked version control systems has built in
the Continuous Integration (travis, jenkins). The <code class="docutils literal"><span class="pre">travis.yml</span></code> is modified
to achieve the online mode.</p>
<p>Currently there are several possible strategies of Online mode implementation:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Using web hooks and communicate with travis by HTTP requests (limited though)</li>
<li>Push stuff through github releases</li>
<li>Custom scripts that can fetch the profile.</li>
</ol>
</div></blockquote>
<p>In travis, this can be implemented within after_success, which means the buggy and
failing build will not be profiled.</p>
</div>
<div class="section" id="mixed-mode">
<h3><a class="toc-backref" href="#id33">Mixed Mode</a><a class="headerlink" href="#mixed-mode" title="Permalink to this headline">¶</a></h3>
<p>Alternates between Offline and Online modes. The user has to state, which workloads
and runners are run online and which offline.</p>
</div>
</div>
<div class="section" id="other-features">
<h2><a class="toc-backref" href="#id34">Other Features</a><a class="headerlink" href="#other-features" title="Permalink to this headline">¶</a></h2>
<p>This section presents other features that are implemented and supported in Perun.</p>
<div class="section" id="notifications">
<h3><a class="toc-backref" href="#id35">Notifications</a><a class="headerlink" href="#notifications" title="Permalink to this headline">¶</a></h3>
<p>Whenever the profile is computed, we can issue a checks, whether e.g. pefromance
degradated, or moved over some given threshold. In case this holds, an notification
is send to emails set in config.</p>
</div>
<div class="section" id="performance-statistics">
<h3><a class="toc-backref" href="#id36">Performance Statistics</a><a class="headerlink" href="#performance-statistics" title="Permalink to this headline">¶</a></h3>
<p>Perun provides various global statistics for each tracked Version Control Systems.
It can generate statistics over the time or over minor and major versions.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><p class="logo">
  <a href="index.html">
    <h3>Perun</h3>
  </a>
</p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Perun Manifesto</a><ul>
<li><a class="reference internal" href="#perun-design-choices">Perun Design Choices</a><ul>
<li><a class="reference internal" href="#language-of-choice">Language of Choice</a></li>
<li><a class="reference internal" href="#cli-framework-of-choice">CLI Framework of Choice</a></li>
<li><a class="reference internal" href="#gui-framework-of-choice">GUI Framework of Choice</a></li>
<li><a class="reference internal" href="#visualization-of-choice">Visualization of Choice</a></li>
<li><a class="reference internal" href="#structure-of-perun">Structure of Perun</a></li>
</ul>
</li>
<li><a class="reference internal" href="#perun-overview">Perun Overview</a></li>
<li><a class="reference internal" href="#perun-command-line-interface">Perun Command Line Interface</a><ul>
<li><a class="reference internal" href="#perun-least-publishable-unit">Perun Least Publishable Unit</a></li>
</ul>
</li>
<li><a class="reference internal" href="#perun-core">Perun Core</a><ul>
<li><a class="reference internal" href="#perun-config">Perun Config</a></li>
<li><a class="reference internal" href="#perun-internals">Perun Internals</a><ul>
<li><a class="reference internal" href="#command-case-study-init-new-perun-control-system">Command Case Study: Init new perun control system</a></li>
<li><a class="reference internal" href="#command-case-study-add-profile">Command Case Study: Add profile</a></li>
<li><a class="reference internal" href="#command-case-study-remove-profile">Command Case Study: Remove profile</a></li>
<li><a class="reference internal" href="#command-case-study-show-profile">Command Case Study: Show profile</a></li>
<li><a class="reference internal" href="#command-case-study-show-all-minor-versions-and-profiles">Command Case Study: Show all minor versions and profiles</a></li>
</ul>
</li>
<li><a class="reference internal" href="#core-logic-package"><code class="docutils literal"><span class="pre">core/logic</span></code> Package</a><ul>
<li><a class="reference internal" href="#job-matrix">Job Matrix</a></li>
<li><a class="reference internal" href="#template-for-runners">Template for Runners</a></li>
<li><a class="reference internal" href="#runner-scheduler">Runner Scheduler</a></li>
</ul>
</li>
<li><a class="reference internal" href="#core-data-package"><code class="docutils literal"><span class="pre">core/data</span></code> Package</a></li>
<li><a class="reference internal" href="#view-package"><code class="docutils literal"><span class="pre">view</span></code> Package</a></li>
</ul>
</li>
<li><a class="reference internal" href="#profiles">Profiles</a><ul>
<li><a class="reference internal" href="#profile-types">Profile types</a><ul>
<li><a class="reference internal" href="#collective-profiles">Collective Profiles</a></li>
<li><a class="reference internal" href="#differential-profiles">Differential Profiles</a></li>
</ul>
</li>
<li><a class="reference internal" href="#profile-visualizations">Profile visualizations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#perun-modes">Perun Modes</a><ul>
<li><a class="reference internal" href="#offline-mode">Offline Mode</a></li>
<li><a class="reference internal" href="#online-mode">Online Mode</a></li>
<li><a class="reference internal" href="#mixed-mode">Mixed Mode</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-features">Other Features</a><ul>
<li><a class="reference internal" href="#notifications">Notifications</a></li>
<li><a class="reference internal" href="#performance-statistics">Performance Statistics</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/manifesto.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Tomas Fiedor, Jiri Pavela, et al..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/manifesto.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>